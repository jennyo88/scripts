#!/usr/bin/env_bash

# tmux reference interactive script

# Function to print the header at the top of the menu
print_header() {
    clear
    echo "==================== TMUX REFERENCE SCRIPT ===================="
    echo "Press Ctrl+C to exit at any time."
    echo ""
}

# Function to check if currently inside a tmux session
is_inside_session() {
    [ -n "$TMUX" ]
}

# Function to display tmux reference information
tmux_reference_info() {
    echo "TMUX Reference Information:"
    echo "1. List sessions"
    echo "2. Show session information"
    echo "3. Exit"
}

# Function to list existing tmux sessions
list_sessions() {
    tmux list-sessions
}

# Function to display information about the current tmux session
show_session_info() {
    tmux display-message -p "#{session_name} (#{session_id}): #{session_windows} windows"
}

# Function for the main menu loop
main_menu() {
    PS3="Choose a tmux command (enter a number): "

    if is_inside_session; then
        tmux_reference_info
    else
        options=(
            "Create a new session"
            "List sessions"
            "Attach to a session"
            "Split pane horizontally"
            "Split pane vertically"
            "Navigate between panes"
            "Close current pane"
            "Rename session"
            "Show session information"
            "Exit"
        )
        select opt in "${options[@]}"; do
            case $REPLY in
                1) create_session ;;
                2) list_sessions ;;
                3) attach_session ;;
                4) split_horizontal ;;
                5) split_vertical ;;
                6) navigate_panes ;;
                7) close_pane ;;
                8) rename_session ;;
                9) show_session_info ;;
                10)
                    echo "Exiting the tmux reference script. Goodbye!"
                    exit 0
                    ;;
                *)
                    echo "Invalid choice. Please enter a valid number."
                    ;;
            esac
        done
    fi
}

# Main loop to display the header and run the main menu
while true; do
    print_header
    main_menu
done
