#!/usr/bin/env bash

# Remote Script Loader

# Function to display available script paths
show_available_paths() {
    echo "Available script paths:"
    echo "1. scripts/convert        - Converting files"
    echo "2. scripts/convert_remote - Uses yt-dlp instead of youtube-dl"
    echo "3. scripts/template_remote - Template to execute a script from GitHub"
    echo "4. scripts/tmux_ref       - Tmux reference"
    echo "5. scripts/test           - Payroll test script"
    # Add more paths as needed
}

# Function to display script menu
display_menu() {
    echo "Script Menu:"
    echo "1. Execute script with custom parameters"
    echo "2. Show available script paths"
    echo "0. Exit"
}

# Function to execute the script
execute_script() {
    # Construct the URL based on user input
    REMOTE_SCRIPT_URL="https://raw.githubusercontent.com/$USERNAME/$REPOSITORY/$BRANCH/$SCRIPT_PATH"

    # Download and execute the remote script using bash -c
    if curl -fsSL "$REMOTE_SCRIPT_URL" | bash; then
        echo "Script execution successful."
    else
        display_error "Failed to execute the remote script. Please check your inputs and try again."
    fi
}

# Prompt the user for GitHub username
printf "Enter GitHub username (default: jennyo88): "
read -r USERNAME
USERNAME=${USERNAME:-jennyo88}

# Prompt the user for repository name
printf "Enter repository name (default: scripts): "
read -r REPOSITORY
REPOSITORY=${REPOSITORY:-scripts}

# Prompt the user for branch name
printf "Enter branch name (default: main): "
read -r BRANCH
BRANCH=${BRANCH:-main}

# Prompt the user for script path or show available paths
while true; do
    echo "------------------------"
    echo "Remote Script Loader Menu"
    echo "------------------------"
    display_menu
    read -r OPTION

    case $OPTION in
        1)
            printf "Enter script path (default: scripts/convert): "
            read -r SCRIPT_PATH
            SCRIPT_PATH=${SCRIPT_PATH:-scripts/convert}
            execute_script
            ;;
        2)
            show_available_paths
            ;;
        0)
            echo "Exiting the script."
            exit 0
            ;;
        *)
            echo "Invalid option. Please choose a valid option."
            ;;
    esac
done
